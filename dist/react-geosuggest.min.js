var Geosuggest=function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])})(t,s)};function s(t,s){function o(){this.constructor=t}e(t,s),t.prototype=null===s?Object.create(s):(o.prototype=s.prototype,new o)}var o=function(){return(o=Object.assign||function(t){for(var e,s=1,o=arguments.length;s<o;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var i,r,u=(function(t){
/*!
      Copyright (c) 2017 Jed Watson.
      Licensed under the MIT License (MIT), see
      http://jedwatson.github.io/classnames
    */
!function(){var e={}.hasOwnProperty;function s(){for(var t=[],o=0;o<arguments.length;o++){var n=arguments[o];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)&&n.length){var r=s.apply(null,n);r&&t.push(r)}else if("object"===i)for(var u in n)e.call(n,u)&&n[u]&&t.push(u)}}return t.join(" ")}t.exports?(s.default=s,t.exports=s):window.classNames=s}()}(r={path:i,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports),p=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,h="object"==typeof n&&n&&n.Object===Object&&n,d="object"==typeof self&&self&&self.Object===Object&&self,f=h||d||Function("return this")(),S=Object.prototype.toString,m=Math.max,y=Math.min,v=function(){return f.Date.now()};function b(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function I(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==S.call(t)}(t))return NaN;if(b(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=b(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(p,"");var s=g.test(t);return s||l.test(t)?c(t.slice(2),s?2:8):a.test(t)?NaN:+t}var w=function(t,e,s){var o,n,i,r,u,p,a=0,g=!1,l=!1,c=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var s=o,i=n;return o=n=void 0,a=e,r=t.apply(i,s)}function d(t){return a=t,u=setTimeout(S,e),g?h(t):r}function f(t){var s=t-p;return void 0===p||s>=e||s<0||l&&t-a>=i}function S(){var t=v();if(f(t))return w(t);u=setTimeout(S,function(t){var s=e-(t-p);return l?y(s,i-(t-a)):s}(t))}function w(t){return u=void 0,c&&o?h(t):(o=n=void 0,r)}function N(){var t=v(),s=f(t);if(o=arguments,n=this,p=t,s){if(void 0===u)return d(p);if(l)return u=setTimeout(S,e),h(p)}return void 0===u&&(u=setTimeout(S,e)),r}return e=I(e)||0,b(s)&&(g=!!s.leading,i=(l="maxWait"in s)?m(I(s.maxWait)||0,e):i,c="trailing"in s?!!s.trailing:c),N.cancel=function(){void 0!==u&&clearTimeout(u),a=0,o=p=n=u=void 0},N.flush=function(){return void 0===u?r:w(v())},N},N={autoActivateFirstSuggest:!1,disabled:!1,fixtures:[],getSuggestLabel:function(t){return t.description},highlightMatch:!0,ignoreEnter:!1,ignoreTab:!1,initialValue:"",maxFixtures:10,minLength:1,onKeyDown:function(){},onKeyPress:function(){},placeholder:"Search places",queryDelay:250,skipSuggest:function(){return!1},style:{},inputType:"text"},C=["autoCapitalize","autoComplete","autoCorrect","autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","height","inputMode","maxLength","name","onClick","onContextMenu","onCopy","onCut","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","pattern","placeholder","readOnly","required","size","spellCheck","tabIndex","title","aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription","aria-activedescendant","aria-autocomplete","aria-multiline","aria-placeholder","aria-readonly","aria-required"];function x(t){var e={};return Object.keys(t).forEach((function(s){var o=s.startsWith("data-");(C.includes(s)||o)&&(e[s]=t[s])})),e}var M=function(e){function n(t){var s=e.call(this,t)||this;return s.input=null,s.onChange=s.onChange.bind(s),s.onInputKeyDown=s.onInputKeyDown.bind(s),s}return s(n,e),n.prototype.onChange=function(){this.input&&this.props.onChange(this.input.value)},n.prototype.onInputKeyDown=function(t){switch(this.props.onKeyDown&&this.props.onKeyDown(t),t.which){case 40:t.shiftKey||(t.preventDefault(),this.props.onNext());break;case 38:t.shiftKey||(t.preventDefault(),this.props.onPrev());break;case 13:this.props.doNotSubmitOnEnter&&t.preventDefault(),this.props.ignoreEnter||this.props.onSelect();break;case 9:this.props.ignoreTab||this.props.onSelect();break;case 27:this.props.onEscape()}},n.prototype.focus=function(){this.input&&this.input.focus()},n.prototype.blur=function(){this.input&&this.input.blur()},n.prototype.render=function(){var e=this,s=x(this.props),n=u("geosuggest__input",this.props.className),i=this.props.label&&this.props.id;return s.tabIndex||(s.tabIndex=0),t.createElement(t.Fragment,null,i&&t.createElement("label",{className:"geosuggest__label",htmlFor:this.props.id},this.props.label),t.createElement("input",o({className:n,id:"geosuggest__input"+(this.props.id?"--"+this.props.id:""),ref:function(t){return e.input=t},type:this.props.inputType},s,{value:this.props.value,style:this.props.style,onKeyDown:this.onInputKeyDown,onChange:this.onChange,onKeyPress:this.props.onKeyPress,onFocus:this.props.onFocus,onBlur:this.props.onBlur,role:"combobox","aria-expanded":!this.props.isSuggestsHidden,"aria-activedescendant":this.props.activeSuggest?this.props.activeSuggest.placeId:void 0,"aria-owns":this.props.listId})))},n.defaultProps={activeSuggest:null,autoComplete:"off",className:"",isSuggestsHidden:!0,listId:"",inputType:"text",onBlur:function(){},onChange:function(){},onEscape:function(){},onFocus:function(){},onKeyDown:function(){},onKeyPress:function(){},onNext:function(){},onPrev:function(){},onSelect:function(){},value:""},n}(t.PureComponent),T=function(e){function o(t){var s=e.call(this,t)||this;return s.ref=null,s.onClick=s.onClick.bind(s),s}return s(o,e),o.prototype.makeBold=function(e,s){return t.createElement("b",{className:"geosuggest__item__matched-text",key:s},e)},o.prototype.formatMatchedText=function(e,s){if(!e||!s.matchedSubstrings)return s.label;var o=s.matchedSubstrings.offset,n=o+s.matchedSubstrings.length,i=this.makeBold(s.label.substring(o,n),s.label),r="",u="";return o>0&&(r=s.label.slice(0,o)),n<s.label.length&&(u=s.label.slice(n)),t.createElement("span",null,r,i,u)},o.prototype.componentDidUpdate=function(t){!t.isActive&&this.props.isActive&&this.scrollIfNeeded()},o.prototype.scrollIfNeeded=function(){var t=this.ref,e=t&&t.parentElement;if(t&&e){var s=t.offsetTop-e.offsetTop<e.scrollTop,o=t.offsetTop-e.offsetTop+t.clientHeight>e.scrollTop+e.clientHeight;(s||o)&&(e.scrollTop=t.offsetTop-e.offsetTop-e.clientHeight/2+t.clientHeight/2)}},o.prototype.onClick=function(t){t.preventDefault(),this.props.onSelect(this.props.suggest)},o.prototype.render=function(){var e,s=this,o=this.props.suggest,n=u("geosuggest__item",this.props.className,this.props.suggestItemClassName,{"geosuggest__item--active":this.props.isActive},((e={})[this.props.activeClassName||""]=this.props.activeClassName?this.props.isActive:null,e)),i=o.label;return this.props.renderSuggestItem?i=this.props.renderSuggestItem(o,this.props.userInput):this.props.isHighlightMatch&&(i=this.formatMatchedText(this.props.userInput,o)),t.createElement("li",{className:n,ref:function(t){return s.ref=t},style:this.props.style,onMouseDown:this.props.onMouseDown,onMouseOut:this.props.onMouseOut,onClick:this.onClick,role:"option","aria-selected":this.props.isActive,id:o.placeId},i)},o}(t.PureComponent),D=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return s(o,e),o.prototype.isHidden=function(){return this.props.isHidden||0===this.props.suggests.length},o.prototype.componentDidUpdate=function(t){t.suggests!==this.props.suggests&&0===this.props.suggests.length&&this.props.onSuggestNoResults()},o.prototype.render=function(){var e,s=this,o=u("geosuggest__suggests",this.props.suggestsClassName,{"geosuggest__suggests--hidden":this.isHidden()},((e={})[this.props.hiddenClassName||""]=this.props.hiddenClassName?this.isHidden():null,e));return t.createElement("ul",{className:o,style:this.props.style,role:"listbox",id:this.props.listId},this.props.suggests.map((function(e){var o=s.props.activeSuggest&&e.placeId===s.props.activeSuggest.placeId||!1;return t.createElement(T,{key:e.placeId,className:e.className||"",userInput:s.props.userInput,isHighlightMatch:s.props.isHighlightMatch,suggest:e,style:s.props.suggestItemStyle,suggestItemClassName:s.props.suggestItemClassName,isActive:o,activeClassName:s.props.suggestItemActiveClassName,onMouseDown:s.props.onSuggestMouseDown,onMouseOut:s.props.onSuggestMouseOut,onSelect:s.props.onSuggestSelect,renderSuggestItem:s.props.renderSuggestItem})})))},o}(t.PureComponent);return function(e){function n(t){var s=e.call(this,t)||this;return s.googleMaps=null,s.autocompleteService=null,s.placesService=null,s.sessionToken=void 0,s.geocoder=null,s.input=null,s.state={activeSuggest:null,ignoreBlur:!1,isLoading:!1,isSuggestsHidden:!0,suggests:[],userInput:t.initialValue||""},s.onInputChange=s.onInputChange.bind(s),s.onAfterInputChange=s.onAfterInputChange.bind(s),s.onInputFocus=s.onInputFocus.bind(s),s.onInputBlur=s.onInputBlur.bind(s),s.onNext=s.onNext.bind(s),s.onPrev=s.onPrev.bind(s),s.onSelect=s.onSelect.bind(s),s.onSuggestMouseDown=s.onSuggestMouseDown.bind(s),s.onSuggestMouseOut=s.onSuggestMouseOut.bind(s),s.onSuggestNoResults=s.onSuggestNoResults.bind(s),s.hideSuggests=s.hideSuggests.bind(s),s.selectSuggest=s.selectSuggest.bind(s),s.listId="geosuggest__list"+(t.id?"--"+t.id:""),t.queryDelay&&(s.onAfterInputChange=w(s.onAfterInputChange,t.queryDelay)),s}return s(n,e),n.prototype.componentDidUpdate=function(t){t.initialValue!==this.props.initialValue&&this.setState({userInput:this.props.initialValue||""}),JSON.stringify(t.fixtures)!==JSON.stringify(this.props.fixtures)&&this.searchSuggests()},n.prototype.componentDidMount=function(){if("undefined"!=typeof window){var t=this.props.googleMaps||window.google&&window.google.maps||this.googleMaps;t?(this.googleMaps=t,this.autocompleteService=new t.places.AutocompleteService,this.placesService=new t.places.PlacesService(document.createElement("div")),this.sessionToken=new t.places.AutocompleteSessionToken,this.geocoder=new t.Geocoder):console&&console.error("Google maps API was not found in the page.")}},n.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},n.prototype.onInputChange=function(t){t||this.props.onSuggestSelect&&this.props.onSuggestSelect(),this.setState({userInput:t},this.onAfterInputChange)},n.prototype.onAfterInputChange=function(){this.showSuggests(),this.props.onChange&&this.props.onChange(this.state.userInput)},n.prototype.onInputFocus=function(){this.props.onFocus&&this.props.onFocus(),this.showSuggests()},n.prototype.onInputBlur=function(){this.state.ignoreBlur||this.hideSuggests()},n.prototype.onNext=function(){this.activateSuggest("next")},n.prototype.onPrev=function(){this.activateSuggest("prev")},n.prototype.onSelect=function(){this.selectSuggest(this.state.activeSuggest)},n.prototype.onSuggestMouseDown=function(){this.setState({ignoreBlur:!0})},n.prototype.onSuggestMouseOut=function(){this.setState({ignoreBlur:!1})},n.prototype.onSuggestNoResults=function(){this.props.onSuggestNoResults&&this.props.onSuggestNoResults(this.state.userInput)},n.prototype.focus=function(){this.input&&this.input.focus()},n.prototype.blur=function(){this.input&&this.input.blur()},n.prototype.update=function(t){this.setState({userInput:t}),this.props.onChange&&this.props.onChange(t)},n.prototype.clear=function(){this.setState({userInput:""},this.hideSuggests)},n.prototype.searchSuggests=function(){var t=this;if(this.state.userInput){var e={input:this.state.userInput,sessionToken:this.sessionToken},s=this.state.userInput.length;if(this.props.minLength&&s<this.props.minLength)this.updateSuggests();else{var o=this.props,n=o.location,i=o.radius,r=o.bounds,u=o.types,p=o.country;n&&(e.location=n),i&&(e.radius=Number(this.props.radius)),r&&(e.bounds=r),u&&(e.types=u),p&&(e.componentRestrictions={country:p}),this.setState({isLoading:!0},(function(){t.autocompleteService?t.autocompleteService.getPlacePredictions(e,(function(e){t.setState({isLoading:!1}),t.updateSuggests(e||[],(function(){t.props.autoActivateFirstSuggest&&!t.state.activeSuggest&&t.activateSuggest("next")}))})):t.setState({isLoading:!1})}))}}else this.updateSuggests()},n.prototype.updateSuggests=function(t,e){var s=this;void 0===t&&(t=[]),void 0===e&&(e=function(){});var n,i=[],r=this.state.userInput,u=this.props,p=u.skipSuggest,a=u.maxFixtures,g=u.fixtures,l=new RegExp(r.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gim"),c=0;g&&g.forEach((function(t){a&&c>=a||p&&!p(t)&&t.label.match(l)&&(c++,i.push(o(o({},t),{isFixture:!0,matchedSubstrings:{length:r.length,offset:t.label.indexOf(r)},placeId:t.placeId||t.label})))})),t.forEach((function(t){p&&!p(t)&&i.push({description:t.description,isFixture:!1,label:s.props.getSuggestLabel?s.props.getSuggestLabel(t):"",matchedSubstrings:t.matched_substrings[0],placeId:t.place_id})})),n=this.updateActiveSuggest(i),this.props.onUpdateSuggests&&this.props.onUpdateSuggests(i,n),this.setState({suggests:i,activeSuggest:n},e)},n.prototype.updateActiveSuggest=function(t){void 0===t&&(t=[]);var e=this.state.activeSuggest;if(e){var s=t.filter((function(t){return e&&e.placeId===t.placeId&&e.isFixture===t.isFixture}))[0];e=s||null}return e},n.prototype.showSuggests=function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},n.prototype.hideSuggests=function(){var t=this;this.props.onBlur&&this.props.onBlur(this.state.userInput),this.timer=window.setTimeout((function(){t.setState({activeSuggest:null,isSuggestsHidden:!0})}),100)},n.prototype.activateSuggest=function(t){if(this.state.isSuggestsHidden)this.showSuggests();else{for(var e=this.state.suggests.length-1,s="next"===t,o=null,n=0,i=0;i<=e;i++)this.state.suggests[i]===this.state.activeSuggest&&(n=s?i+1:i-1);this.state.activeSuggest||(n=s?0:e),n>=0&&n<=e&&(o=this.state.suggests[n]),this.props.onActivateSuggest&&this.props.onActivateSuggest(o),this.setState({activeSuggest:o})}},n.prototype.selectSuggest=function(t){var e=t||{isFixture:!0,label:this.state.userInput,placeId:this.state.userInput};if(!t&&this.props.autoActivateFirstSuggest&&this.state.suggests.length>0&&(e=this.state.suggests[0]),this.setState({isSuggestsHidden:!0,userInput:"object"!=typeof e.label?e.label:e.description||""}),e.location)return this.setState({ignoreBlur:!1}),void(this.props.onSuggestSelect&&this.props.onSuggestSelect(e));this.geocodeSuggest(e)},n.prototype.geocodeSuggest=function(t){var e=this;if(this.geocoder)if(t.placeId&&!t.isFixture&&this.placesService){var s={placeId:t.placeId,sessionToken:this.sessionToken};this.props.placeDetailFields&&(s.fields=this.props.placeDetailFields,s.fields.unshift("geometry")),this.placesService.getDetails(s,(function(s,n){if(n===e.googleMaps.places.PlacesServiceStatus.OK){var i=s,r=i.geometry&&i.geometry.location,u=o(o({},t),{gmaps:i,location:{lat:r.lat(),lng:r.lng()}});e.sessionToken=new google.maps.places.AutocompleteSessionToken,e.props.onSuggestSelect&&e.props.onSuggestSelect(u)}}))}else{s={address:t.label,bounds:this.props.bounds,componentRestrictions:this.props.country?{country:this.props.country}:void 0,location:this.props.location};this.geocoder.geocode(s,(function(s,n){if(n===e.googleMaps.GeocoderStatus.OK){var i=s[0],r=i.geometry&&i.geometry.location,u=o(o({},t),{gmaps:i,location:{lat:r.lat(),lng:r.lng()}});e.props.onSuggestSelect&&e.props.onSuggestSelect(u)}}))}},n.prototype.render=function(){var e=this,s=x(this.props),n=u("geosuggest",this.props.className,{"geosuggest--loading":this.state.isLoading}),i=t.createElement(M,o({className:this.props.inputClassName,ref:function(t){return e.input=t},value:this.state.userInput,doNotSubmitOnEnter:!this.state.isSuggestsHidden,ignoreTab:this.props.ignoreTab,ignoreEnter:this.props.ignoreEnter,style:this.props.style&&this.props.style.input,onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,onKeyPress:this.props.onKeyPress,inputType:this.props.inputType,onNext:this.onNext,onPrev:this.onPrev,onSelect:this.onSelect,onEscape:this.hideSuggests,isSuggestsHidden:this.state.isSuggestsHidden,activeSuggest:this.state.activeSuggest,label:this.props.label,id:this.props.id,listId:this.listId},s)),r=t.createElement(D,{isHidden:this.state.isSuggestsHidden,style:this.props.style&&this.props.style.suggests,suggestItemStyle:this.props.style&&this.props.style.suggestItem,userInput:this.state.userInput,isHighlightMatch:Boolean(this.props.highlightMatch),suggestsClassName:this.props.suggestsClassName,suggestItemClassName:this.props.suggestItemClassName,suggests:this.state.suggests,hiddenClassName:this.props.suggestsHiddenClassName,suggestItemActiveClassName:this.props.suggestItemActiveClassName,activeSuggest:this.state.activeSuggest,onSuggestNoResults:this.onSuggestNoResults,onSuggestMouseDown:this.onSuggestMouseDown,onSuggestMouseOut:this.onSuggestMouseOut,onSuggestSelect:this.selectSuggest,renderSuggestItem:this.props.renderSuggestItem,listId:this.listId});return t.createElement("div",{className:n,id:this.props.id},t.createElement("div",{className:"geosuggest__input-wrapper"},i),t.createElement("div",{className:"geosuggest__suggests-wrapper"},r))},n.defaultProps=N,n}(t.Component)}(React);
